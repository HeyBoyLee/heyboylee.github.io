---
layout: post
title:  "网页加载过程总结"
date:   2016-08-11 10:14:54
categories: 开发者手册
---

## 浏览器加载渲染网页过程解析

![load-img](http://img9.ph.126.net/KYpe5cS9p1UYwkQVpNpB0A==/2713981725461689689.jpg)

由上图能看出网页的加载顺序：

1、下载顺序是从上而下的，渲染顺序也是从上而下的，下载和渲染是同时进行的。

2、在渲染到页面的某一部分时，其上面的所有部分都已经下载完成（并不是说所有相关联的元素都已经下载完）。

3、如果遇到语义解释性的标签嵌入文件（JS脚本，CSS)的下载过程会启用单独连接进行下载。

4、并且在下载后进行解析，解析过程中，停止页面所有往下元素的下载。

5、样式表在下载完成后，将和以前下载的所有样式表一起进行解析，解析完成后，将对此前所有元素（含以前已经渲染的）重新进行渲染。

6、JS、CSS中如有重定义，后定义函数将覆盖前定义函数。

## 网页生成过程

![page-img](http://www.ruanyifeng.com/blogimg/asset/2015/bg2015091501.png)

网页生成过程，大致分为五步：

	1、HTML代码转化成DOM
	2、CSS代码转化成CSSOM（CSS Object Model）
	3、结合DOM和CSSOM，生成一棵渲染树（包含每个节点的视觉信息）
	4、生成布局（layout），即将所有渲染树的所有节点进行平面合成
	5、将布局绘制（paint）在屏幕上
	
这五步里面，第一步到第三步都非常快，耗时的是第四步和第五步。

**"生成布局"（flow）和"绘制"（paint）这两步，合称为"渲染"（render）。**

![pro-img](http://www.ruanyifeng.com/blogimg/asset/2015/bg2015091502.png)

## 重排和重绘
网页生成的时候，至少会渲染一次。用户访问的过程中，还会不断重新渲染。

以下三种情况，会导致网页重新渲染。

	修改DOM
	修改样式表
	用户事件（比如鼠标悬停、页面滚动、输入框键入文字、改变窗口大小等等）
	
重新渲染，就需要重新生成布局和重新绘制。
前者叫做"重排"（reflow），后者叫做"重绘"（repaint)。

需要注意的是，"重绘"不一定需要"重排"，比如改变某个网页元素的颜色，就只会触发"重绘"，不会触发"重排"，因为布局没有改变。但是，"重排"必然导致"重绘"，比如改变一个网页元素的位置，就会同时触发"重排"和"重绘"，因为布局改变了。